;; The first three lines of this file were inserted by DrRacket. They record metadata
;; about the language level of this file in a form that our tools can easily process.
#reader(lib "htdp-intermediate-lambda-reader.ss" "lang")((modname bst-exercise) (read-case-sensitive #t) (teachpacks ()) (htdp-settings #(#t constructor repeating-decimal #f #t none #f () #f)))
;; Chapter Binary Trees

(define-struct node (key left right))

(define test-tree (make-node 5 (make-node 1 (make-node 3 '() '())
                                          (make-node 6 '() '()))
                             (make-node 1 (make-node 1 (make-node 4 '() '())
                                                     (make-node 6 '() '()))
                                        (make-node 3 '() '()))))


;; Ex. 1

(define (count-leaves t)
  (cond [(empty? t) 0]
        [(and (empty? (node-right t)) (empty? (node-left t))) 1]
        [else (+ (count-leaves (node-left t)) (count-leaves (node-right t)))])  
  )

(check-expect (count-leaves empty) 0)
(check-expect (count-leaves test-tree) 5)
(check-expect (count-leaves (make-node 10 empty empty)) 1)
(check-expect (count-leaves (make-node 10 (make-node 5 empty empty)
                                       empty)) 1)
(check-expect (count-leaves (make-node 10 (make-node 5 empty empty)
                                       (make-node 5 empty empty))) 2)


;; Ex. 2

(define (count-evens t)
  (cond [(empty? t) 0]
        [(= (modulo (node-key t) 2) 0) (+ 1 (count-evens (node-left t)) (count-evens (node-right t)))]
        [else (+ (count-evens (node-left t)) (count-evens (node-right t)))])
  )

(check-expect (count-evens empty) 0)
(check-expect (count-evens test-tree) 3)
(check-expect (count-evens (make-node 10 empty empty)) 1)
(check-expect (count-evens (make-node 10 (make-node 5 empty empty)
                                       empty)) 1)
(check-expect (count-evens (make-node 10 (make-node 5 empty empty)
                                       (make-node 5 empty empty))) 1)
(check-expect (count-evens (make-node 10 (make-node 8 empty empty)
                                       (make-node 6 empty empty))) 3)


;; Ex. 3

(define (reverse-tree t)
  (cond
    [(empty? t) empty]
    [else (make-node (node-key t)
                     (reverse-tree (node-right t))
                     (reverse-tree (node-left t)))]
    )
  )

(check-expect (reverse-tree empty) empty)
(check-expect
 (reverse-tree (make-node 1 (make-node 2 (make-node 5 empty empty) '()) (make-node 3 '() '())))
 (make-node 1 (make-node 3 '() '()) (make-node 2 '() (make-node 5 empty empty))))




